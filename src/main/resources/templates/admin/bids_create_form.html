<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<!-- HEADER -->
<head th:replace="fragments/admin/header :: header"></head>

<body>

<!-- TOPNAV -->
<nav th:replace="fragments/admin/topnav :: topnav"></nav>

<!-- CONTENT -->
<div class="container-fluid">
    <div class="row">

        <!-- SIDENAV -->
        <div class="col-md-2">
            <ul th:replace="fragments/admin/sidenav :: sidenav"></ul>
        </div>

        <!-- CONTENT -->
        <div class="col-md-10">

            <h3>Auction details</h3>

            <table class="table">
                <thead>
                <tr>
                    <th>id</th>
                    <th>start_date</th>
                    <th>end_date</th>
                </tr>
                </thead>
                <tr>
                    <td th:text="${auction.id}"></td>
                    <td th:text="${auction.startDate} + ' ' + ${auction.startTime}"></td>
                    <td th:text="${auction.endDate} + ' ' + ${auction.endTime}"></td>
                </tr>
            </table>

            <h3>Create new bid</h3>

            <div th:if="${AT_LEAST_ONE} != null">
                <p th:text="${AT_LEAST_ONE}"
                   style="color: red;"></p>
            </div>

            <div th:if="${AMOUNT_NONCOMPETITIVE} != null">
                <p th:text="${AMOUNT_NONCOMPETITIVE}"
                   style="color: red;"></p>
            </div>

            <form class="form-inline" th:action="@{/admin/bids/store}" th:object="${form}" method="post">

                <input type="hidden" th:name="auction_id" th:value="${auction.id}">

                <table class="table">
                    <thead>
                    <tr>
                        <th>Security name</th>
                        <th>Type</th>
                        <th>Offering Amount</th>
                        <th>Amount</th>
                        <th>Rate</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="treasurySecurity, itemStat: ${auction.treasurySecurityList}">

                        <input type="hidden"
                               id="treasurySecurity"
                               th:name="${'bidDTOS['+__${itemStat.index}__+'].treasurySecurity'}"
                               th:value="${treasurySecurity.id}">

                        <td th:text="${treasurySecurity.securityName}"></td>

                        <td>
                            <select class="form-control" id="isCompetitive"
                                    th:field="*{bidDTOS[__${itemStat.index}__].isCompetitive}">
                                <option th:value="0" th:text="Noncompetitive"></option>
                                <option th:value="1" th:text="Competitive"></option>
                            </select>
                        </td>

                        <td th:text="${treasurySecurity.totalAmount}"></td>

                        <td>
                            <input type="number" class="form-control" id="amount"
                                   th:field="*{bidDTOS[__${itemStat.index}__].amount}" required>

                            <div th:if="${__${'AMOUNT_POSITIVE_' + itemStat.index}__} != null">
                                <p th:text="${__${'AMOUNT_POSITIVE_' + itemStat.index}__}" style="color: red;"></p>
                            </div>
                            <div th:if="${__${'AMOUNT_COMPETITIVE_' + itemStat.index}__} != null">
                                <p th:text="${__${'AMOUNT_COMPETITIVE_' + itemStat.index}__}" style="color: red;"></p>
                            </div>
                            <div th:if="${__${'AMOUNT_HUNDRED_' + itemStat.index}__} != null">
                                <p th:text="${__${'AMOUNT_HUNDRED_' + itemStat.index}__}" style="color: red;"></p>
                            </div>
                        </td>

                        <td>
                            <input type="number" step="0.1" class="form-control" id="rate"
                                   th:field="*{bidDTOS[__${itemStat.index}__].rate}" required>

                            <div th:if="${__${'RATE_RANGE_' + itemStat.index}__} != null">
                                <p th:text="${__${'RATE_RANGE_' + itemStat.index}__}" style="color: red;"></p>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>

                <button type="submit" class="btn btn-primary">Submit</button>

            </form>
        </div>
    </div>
</div>

<!-- FOOTER -->
<footer th:replace="fragments/admin/footer :: footer"></footer>

</body>
</html>